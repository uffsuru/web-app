{% extends "base.html" %}

{% block title %}Edit Auction - AuctionHub{% endblock %}

{% block content %}
<div class="container" style="max-width: 600px; margin: 2rem auto; background: #fff; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.07);">
    <h2 style="text-align:center; margin-bottom: 2rem;">Edit Auction</h2>
    
    {% if error %}
        <div class="alert alert-danger" style="color: #721c24; background-color: #f8d7da; border-color: #f5c6cb; padding: .75rem 1.25rem; margin-bottom: 1rem; border: 1px solid transparent; border-radius: .25rem;">{{ error }}</div>
    {% endif %}

    <form method="POST" action="{{ url_for('edit_auction', auction_id=auction.id) }}" enctype="multipart/form-data">
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="title">Title</label>
            <input type="text" id="title" name="title" class="form-control" required style="width:100%; padding:0.5rem;" value="{{ auction.title }}">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="description">Description</label>
            <textarea id="description" name="description" class="form-control" required style="width:100%; padding:0.5rem; min-height: 80px;">{{ auction.description }}</textarea>
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="starting_price">Starting Price (â‚¹) - Cannot be changed</label>
            <input type="number" id="starting_price" name="starting_price" class="form-control" value="{{ auction.starting_price }}" style="width:100%; padding:0.5rem; background-color: #e9ecef;" disabled>
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="end_time">End Time</label>
            <input type="datetime-local" id="end_time" name="end_time" class="form-control" required style="width:100%; padding:0.5rem;" value="{{ auction.end_time.strftime('%Y-%m-%dT%H:%M') if auction.end_time else '' }}">
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="category">Category</label>
            <select id="category" name="category" class="form-control" required style="width:100%; padding:0.5rem;">
                <option value="">Select Category</option>
                {% set categories = ["Clothes", "Electronics", "Wooden", "Watches", "Collectibles", "Art", "Music", "Fashion", "Sports"] %}
                {% for cat in categories %}
                    <option value="{{ cat }}" {% if auction.category == cat %}selected{% endif %}>{{ cat }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group" style="margin-bottom: 1rem;">
            <label for="history_link">Item History Link (Optional)</label>
            <input type="url" id="history_link" name="history_link" class="form-control" placeholder="https://example.com/item-history" style="width:100%; padding:0.5rem;" value="{{ auction.history_link or '' }}">
        </div>
        <div class="form-group" style="margin-bottom: 1.5rem;">
            <label for="image_file">Change Image or File (Optional)</label>
            {% if auction.image_url and 'uploads' in auction.image_url %}
                <div style="margin-bottom: 1rem;">
                    <p style="font-size: 0.9em; margin-bottom: 4px;">Current Image:</p>
                    <img src="{{ url_for('static', filename=auction.image_url) }}" alt="Current image for {{ auction.title }}" style="max-width: 150px; max-height: 150px; border-radius: 8px; border: 1px solid #ddd;">
                </div>
            {% elif auction.image_url %}
                <p style="font-size: 0.9em; margin-top: 4px;">Current: (Emoji icon)</p>
            {% endif %}
            <input type="file" id="image_file" name="image_file" class="form-control" style="width:100%; padding:0.5rem;" accept=".jpg,.jpeg,.png,.gif,.pdf,.webp,.bmp,.tiff,.svg">
        </div>
        <button type="submit" class="btn btn-success" style="width:100%; padding:0.7rem; font-size:1.1rem; background:#28a745; color:#fff; border:none; border-radius:8px; font-weight:600;">Save Changes</button>
    </form>
    <div style="text-align:center; margin-top:1rem;">
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
    </div>
</div>
{% endblock %}